package com.security.vulnscanner.dto;

import com.security.vulnscanner.model.Vulnerability;
import lombok.Data;

import java.time.LocalDateTime;

@Data
public class VulnerabilityResponse {
    private Long id;
    private String title;
    private String description;
    private String severity;
    private Double cvssScore;
    private String cveId;
    private String cweId;
    private String category;
    private String affectedUrl;
    private String evidence;
    private String remediation;
    private String references;
    private boolean falsePositive;
    private boolean resolved;
    private LocalDateTime detectedAt;

    public static VulnerabilityResponse fromEntity(Vulnerability vuln) {
        VulnerabilityResponse response = new VulnerabilityResponse();
        response.setId(vuln.getId());
        response.setTitle(vuln.getTitle());
        response.setDescription(vuln.getDescription());
        response.setSeverity(vuln.getSeverity().toString());
        response.setCvssScore(vuln.getCvssScore());
        response.setCveId(vuln.getCveId());
        response.setCweId(vuln.getCweId());
        response.setCategory(vuln.getCategory());
        response.setAffectedUrl(vuln.getAffectedUrl());
        response.setEvidence(vuln.getEvidence());
        response.setRemediation(vuln.getRemediation());
        response.setReferences(vuln.getReferences());
        response.setFalsePositive(vuln.isFalsePositive());
        response.setResolved(vuln.isResolved());
        response.setDetectedAt(vuln.getDetectedAt());
        return response;
    }
}
